import matplotlib.pyplot as plt
import pandas as pd
from datetime import datetime, timedelta
import csv
import numpy as np

df = pd.read_csv ('final_file-resumen.csv', usecols= ['Numero Origen','Numero Marcado Final', 'Origen', 'Destino', 'Tiempo de Desconexion', 'Duracion(s)'], low_memory=False)
df_new = df.rename(columns={'Numero Origen': 'Numero', 'Numero Marcado Final': 'NumeroSaliente', 'Tiempo de Desconexion' : 'Hora', 'Duracion(s)' : 'Duracion'})

print('Escriba los días que desea revisar en formato dd/mm, ejemplo 02/Dec:')
dia1 = input()
dia2 = input()
dia3 = input()
dia4 = input()
dia5 = input()
dia6 = input()
dia7 = input()

paises = ['Argentina', 'Brasil', 'Bolivia', 'Colombia', 'Espana',
 'Ecuador', 'Mexico', 'Peru', 'Paraguay', 'Panama', 'TYT', 'Uruguay']

Horas = ['7 AM', '8 AM', '9 AM', '10 AM', '11 AM', '12 PM', '1 PM', '2 PM', '3 PM', '4 PM', '5 PM', '6 PM'  ]

for i in paises:
    #Dia 1 llamada entrante de PSTN
    entrante_pstn_dia1_7am = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("07:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia1_8am = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("08:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia1_9am = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("09:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia1_10am = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("10:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia1_11am = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("11:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia1_12pm = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("12:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia1_1pm = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("01:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia1_2pm = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("02:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]           
    entrante_pstn_dia1_3pm = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("03:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia1_4pm = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("04:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia1_5pm = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("05:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia1_6pm = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("06:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]

 #Dia 2 llamada entrante de PSTN
    entrante_pstn_dia2_7am = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("07:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia2_8am = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("08:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia2_9am = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("09:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia2_10am = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("10:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia2_11am = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("11:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia2_12pm = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("12:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia2_1pm = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("01:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia2_2pm = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("02:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]           
    entrante_pstn_dia2_3pm = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("03:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia2_4pm = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("04:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia2_5pm = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("05:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia2_6pm = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("06:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]

 #Dia 3 llamada entrante de PSTN
    entrante_pstn_dia3_7am = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("07:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia3_8am = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("08:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia3_9am = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("09:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia3_10am = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("10:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia3_11am = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("11:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia3_12pm = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("12:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia3_1pm = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("01:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia3_2pm = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("02:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]           
    entrante_pstn_dia3_3pm = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("03:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia3_4pm = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("04:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia3_5pm = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("05:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia3_6pm = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("06:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]

 #Dia 4 llamada entrante de PSTN
    entrante_pstn_dia4_7am = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("07:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia4_8am = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("08:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia4_9am = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("09:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia4_10am = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("10:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia4_11am = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("11:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia4_12pm = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("12:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia4_1pm = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("01:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia4_2pm = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("02:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]           
    entrante_pstn_dia4_3pm = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("03:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia4_4pm = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("04:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia4_5pm = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("05:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia4_6pm = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("06:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]

 #Dia 5 llamada entrante de PSTN
    entrante_pstn_dia5_7am = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("07:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia5_8am = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("08:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia5_9am = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("09:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia5_10am = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("10:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia5_11am = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("11:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia5_12pm = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("12:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia5_1pm = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("01:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia5_2pm = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("02:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]           
    entrante_pstn_dia5_3pm = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("03:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia5_4pm = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("04:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia5_5pm = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("05:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia5_6pm = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("06:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]

 #Dia 6 llamada entrante de PSTN
    entrante_pstn_dia6_7am = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("07:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia6_8am = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("08:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia6_9am = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("09:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia6_10am = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("10:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia6_11am = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("11:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia6_12pm = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("12:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia6_1pm = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("01:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia6_2pm = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("02:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]           
    entrante_pstn_dia6_3pm = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("03:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia6_4pm = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("04:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia6_5pm = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("05:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia6_6pm = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("06:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]

 #Dia 7 llamada entrante de PSTN
    entrante_pstn_dia7_7am = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("07:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia7_8am = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("08:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia7_9am = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("09:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia7_10am = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("10:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia7_11am = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("11:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia7_12pm = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("12:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia7_1pm = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("01:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia7_2pm = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("02:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]           
    entrante_pstn_dia7_3pm = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("03:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia7_4pm = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("04:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia7_5pm = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("05:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    entrante_pstn_dia7_6pm = df_new[(df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("06:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]


    entrante_pstn_promedio_7am = round((len(entrante_pstn_dia1_7am)+len(entrante_pstn_dia2_7am)+len(entrante_pstn_dia3_7am)+len(entrante_pstn_dia4_7am)+len(entrante_pstn_dia5_7am)+len(entrante_pstn_dia6_7am)+len(entrante_pstn_dia7_7am))/7)
    entrante_pstn_promedio_8am = round((len(entrante_pstn_dia1_8am)+len(entrante_pstn_dia2_8am)+len(entrante_pstn_dia3_8am)+len(entrante_pstn_dia4_8am)+len(entrante_pstn_dia5_8am)+len(entrante_pstn_dia6_8am)+len(entrante_pstn_dia7_8am))/7)
    entrante_pstn_promedio_9am = round((len(entrante_pstn_dia1_9am)+len(entrante_pstn_dia2_9am)+len(entrante_pstn_dia3_9am)+len(entrante_pstn_dia4_9am)+len(entrante_pstn_dia5_9am)+len(entrante_pstn_dia6_9am)+len(entrante_pstn_dia7_9am))/7)
    entrante_pstn_promedio_10am = round((len(entrante_pstn_dia1_10am)+len(entrante_pstn_dia2_10am)+len(entrante_pstn_dia3_10am)+len(entrante_pstn_dia4_10am)+len(entrante_pstn_dia5_10am)+len(entrante_pstn_dia6_10am)+len(entrante_pstn_dia7_10am))/7)
    entrante_pstn_promedio_11am = round((len(entrante_pstn_dia1_11am)+len(entrante_pstn_dia2_11am)+len(entrante_pstn_dia3_11am)+len(entrante_pstn_dia4_11am)+len(entrante_pstn_dia5_11am)+len(entrante_pstn_dia6_11am)+len(entrante_pstn_dia7_11am))/7)
    entrante_pstn_promedio_12pm = round((len(entrante_pstn_dia1_12pm)+len(entrante_pstn_dia2_12pm)+len(entrante_pstn_dia3_12pm)+len(entrante_pstn_dia4_12pm)+len(entrante_pstn_dia5_12pm)+len(entrante_pstn_dia6_12pm)+len(entrante_pstn_dia7_12pm))/7)
    entrante_pstn_promedio_1pm = round((len(entrante_pstn_dia1_1pm)+len(entrante_pstn_dia2_1pm)+len(entrante_pstn_dia3_1pm)+len(entrante_pstn_dia4_1pm)+len(entrante_pstn_dia5_1pm)+len(entrante_pstn_dia6_1pm)+len(entrante_pstn_dia7_1pm))/7)
    entrante_pstn_promedio_2pm = round((len(entrante_pstn_dia1_2pm)+len(entrante_pstn_dia2_2pm)+len(entrante_pstn_dia3_2pm)+len(entrante_pstn_dia4_2pm)+len(entrante_pstn_dia5_2pm)+len(entrante_pstn_dia6_2pm)+len(entrante_pstn_dia7_2pm))/7)
    entrante_pstn_promedio_3pm = round((len(entrante_pstn_dia1_3pm)+len(entrante_pstn_dia2_3pm)+len(entrante_pstn_dia3_3pm)+len(entrante_pstn_dia4_3pm)+len(entrante_pstn_dia5_3pm)+len(entrante_pstn_dia6_3pm)+len(entrante_pstn_dia7_3pm))/7)
    entrante_pstn_promedio_4pm = round((len(entrante_pstn_dia1_4pm)+len(entrante_pstn_dia2_4pm)+len(entrante_pstn_dia3_4pm)+len(entrante_pstn_dia4_4pm)+len(entrante_pstn_dia5_4pm)+len(entrante_pstn_dia6_4pm)+len(entrante_pstn_dia7_4pm))/7)
    entrante_pstn_promedio_5pm = round((len(entrante_pstn_dia1_5pm)+len(entrante_pstn_dia2_5pm)+len(entrante_pstn_dia3_5pm)+len(entrante_pstn_dia4_5pm)+len(entrante_pstn_dia5_5pm)+len(entrante_pstn_dia6_5pm)+len(entrante_pstn_dia7_5pm))/7)
    entrante_pstn_promedio_6pm = round((len(entrante_pstn_dia1_6pm)+len(entrante_pstn_dia2_6pm)+len(entrante_pstn_dia3_6pm)+len(entrante_pstn_dia4_6pm)+len(entrante_pstn_dia5_6pm)+len(entrante_pstn_dia6_6pm)+len(entrante_pstn_dia7_6pm))/7)

    entrante_pstn_promedio_semana = [entrante_pstn_promedio_7am, entrante_pstn_promedio_8am, entrante_pstn_promedio_9am, 
                      entrante_pstn_promedio_10am, entrante_pstn_promedio_11am, entrante_pstn_promedio_12pm, entrante_pstn_promedio_1pm, entrante_pstn_promedio_2pm, 
                      entrante_pstn_promedio_3pm, entrante_pstn_promedio_4pm, entrante_pstn_promedio_5pm, entrante_pstn_promedio_6pm]

    plt.ylabel('Número de llamadas')
    plt.title('Promedio de llamadas entrantes de la PSTN por hora en ' + i + ' del ' + dia1 + ' - ' + dia7)
    rects = plt.bar(Horas,entrante_pstn_promedio_semana, width=0.5)

    for r in rects:
        height = r.get_height() 
        plt.text(r.get_x() + r.get_width()/2.0, height, '%d' % int(height), ha='center', va='bottom')

    plt.show()

    #Dia 1 llamada saliente PSTN
    saliente_pstn_dia1_7am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("07:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia1_8am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("08:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia1_9am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("09:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia1_10am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("10:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia1_11am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("11:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia1_12pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("12:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia1_1pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("01:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia1_2pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("02:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]           
    saliente_pstn_dia1_3pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("03:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia1_4pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("04:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia1_5pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("05:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia1_6pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("06:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]

 #Dia 2 llamada saliente PSTN
    saliente_pstn_dia2_7am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("07:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia2_8am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("08:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia2_9am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("09:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia2_10am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("10:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia2_11am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("11:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia2_12pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("12:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia2_1pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("01:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia2_2pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("02:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]           
    saliente_pstn_dia2_3pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("03:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia2_4pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("04:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia2_5pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("05:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia2_6pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("06:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]

 #Dia 3 llamada saliente PSTN
    saliente_pstn_dia3_7am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("07:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia3_8am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("08:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia3_9am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("09:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia3_10am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("10:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia3_11am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("11:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia3_12pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("12:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia3_1pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("01:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia3_2pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("02:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]           
    saliente_pstn_dia3_3pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("03:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia3_4pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("04:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia3_5pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("05:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia3_6pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("06:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]

 #Dia 4 llamada saliente PSTN
    saliente_pstn_dia4_7am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("07:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia4_8am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("08:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia4_9am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("09:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia4_10am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("10:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia4_11am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("11:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia4_12pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("12:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia4_1pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("01:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia4_2pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("02:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]           
    saliente_pstn_dia4_3pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("03:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia4_4pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("04:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia4_5pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("05:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia4_6pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("06:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]

 #Dia 5 llamada saliente PSTN
    saliente_pstn_dia5_7am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("07:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia5_8am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("08:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia5_9am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("09:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia5_10am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("10:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia5_11am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("11:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia5_12pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("12:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia5_1pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("01:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia5_2pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("02:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]           
    saliente_pstn_dia5_3pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("03:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia5_4pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("04:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia5_5pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("05:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia5_6pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("06:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]

 #Dia 6 llamada saliente PSTN
    saliente_pstn_dia6_7am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("07:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia6_8am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("08:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia6_9am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("09:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia6_10am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("10:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia6_11am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("11:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia6_12pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("12:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia6_1pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("01:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia6_2pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("02:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]           
    saliente_pstn_dia6_3pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("03:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia6_4pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("04:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia6_5pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("05:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia6_6pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("06:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]

 #Dia 7 llamada saliente PSTN
    saliente_pstn_dia7_7am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("07:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia7_8am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("08:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia7_9am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("09:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia7_10am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("10:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia7_11am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("11:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia7_12pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("12:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia7_1pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("01:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia7_2pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("02:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]           
    saliente_pstn_dia7_3pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("03:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia7_4pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("04:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia7_5pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("05:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    saliente_pstn_dia7_6pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("06:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.astype(str).map(len) > 4) & (df_new.Duracion.astype(str).map(len) > 0)]


    saliente_pstn_promedio_7am = round((len(saliente_pstn_dia1_7am)+len(saliente_pstn_dia2_7am)+len(saliente_pstn_dia3_7am)+len(saliente_pstn_dia4_7am)+len(saliente_pstn_dia5_7am)+len(saliente_pstn_dia6_7am)+len(saliente_pstn_dia7_7am))/7)
    saliente_pstn_promedio_8am = round((len(saliente_pstn_dia1_8am)+len(saliente_pstn_dia2_8am)+len(saliente_pstn_dia3_8am)+len(saliente_pstn_dia4_8am)+len(saliente_pstn_dia5_8am)+len(saliente_pstn_dia6_8am)+len(saliente_pstn_dia7_8am))/7)
    saliente_pstn_promedio_9am = round((len(saliente_pstn_dia1_9am)+len(saliente_pstn_dia2_9am)+len(saliente_pstn_dia3_9am)+len(saliente_pstn_dia4_9am)+len(saliente_pstn_dia5_9am)+len(saliente_pstn_dia6_9am)+len(saliente_pstn_dia7_9am))/7)
    saliente_pstn_promedio_10am = round((len(saliente_pstn_dia1_10am)+len(saliente_pstn_dia2_10am)+len(saliente_pstn_dia3_10am)+len(saliente_pstn_dia4_10am)+len(saliente_pstn_dia5_10am)+len(saliente_pstn_dia6_10am)+len(saliente_pstn_dia7_10am))/7)
    saliente_pstn_promedio_11am = round((len(saliente_pstn_dia1_11am)+len(saliente_pstn_dia2_11am)+len(saliente_pstn_dia3_11am)+len(saliente_pstn_dia4_11am)+len(saliente_pstn_dia5_11am)+len(saliente_pstn_dia6_11am)+len(saliente_pstn_dia7_11am))/7)
    saliente_pstn_promedio_12pm = round((len(saliente_pstn_dia1_12pm)+len(saliente_pstn_dia2_12pm)+len(saliente_pstn_dia3_12pm)+len(saliente_pstn_dia4_12pm)+len(saliente_pstn_dia5_12pm)+len(saliente_pstn_dia6_12pm)+len(saliente_pstn_dia7_12pm))/7)
    saliente_pstn_promedio_1pm = round((len(saliente_pstn_dia1_1pm)+len(saliente_pstn_dia2_1pm)+len(saliente_pstn_dia3_1pm)+len(saliente_pstn_dia4_1pm)+len(saliente_pstn_dia5_1pm)+len(saliente_pstn_dia6_1pm)+len(saliente_pstn_dia7_1pm))/7)
    saliente_pstn_promedio_2pm = round((len(saliente_pstn_dia1_2pm)+len(saliente_pstn_dia2_2pm)+len(saliente_pstn_dia3_2pm)+len(saliente_pstn_dia4_2pm)+len(saliente_pstn_dia5_2pm)+len(saliente_pstn_dia6_2pm)+len(saliente_pstn_dia7_2pm))/7)
    saliente_pstn_promedio_3pm = round((len(saliente_pstn_dia1_3pm)+len(saliente_pstn_dia2_3pm)+len(saliente_pstn_dia3_3pm)+len(saliente_pstn_dia4_3pm)+len(saliente_pstn_dia5_3pm)+len(saliente_pstn_dia6_3pm)+len(saliente_pstn_dia7_3pm))/7)
    saliente_pstn_promedio_4pm = round((len(saliente_pstn_dia1_4pm)+len(saliente_pstn_dia2_4pm)+len(saliente_pstn_dia3_4pm)+len(saliente_pstn_dia4_4pm)+len(saliente_pstn_dia5_4pm)+len(saliente_pstn_dia6_4pm)+len(saliente_pstn_dia7_4pm))/7)
    saliente_pstn_promedio_5pm = round((len(saliente_pstn_dia1_5pm)+len(saliente_pstn_dia2_5pm)+len(saliente_pstn_dia3_5pm)+len(saliente_pstn_dia4_5pm)+len(saliente_pstn_dia5_5pm)+len(saliente_pstn_dia6_5pm)+len(saliente_pstn_dia7_5pm))/7)
    saliente_pstn_promedio_6pm = round((len(saliente_pstn_dia1_6pm)+len(saliente_pstn_dia2_6pm)+len(saliente_pstn_dia3_6pm)+len(saliente_pstn_dia4_6pm)+len(saliente_pstn_dia5_6pm)+len(saliente_pstn_dia6_6pm)+len(saliente_pstn_dia7_6pm))/7)

    saliente_pstn_promedio_semana = [saliente_pstn_promedio_7am, saliente_pstn_promedio_8am, saliente_pstn_promedio_9am, 
                      saliente_pstn_promedio_10am, saliente_pstn_promedio_11am, saliente_pstn_promedio_12pm, saliente_pstn_promedio_1pm, saliente_pstn_promedio_2pm, 
                      saliente_pstn_promedio_3pm, saliente_pstn_promedio_4pm, saliente_pstn_promedio_5pm, saliente_pstn_promedio_6pm]

    plt.ylabel('Número de llamadas')
    plt.title('Promedio de llamadas salientes a la PSTN por hora en ' + i + ' del ' + dia1 + ' - ' + dia7)
    rects = plt.bar(Horas,saliente_pstn_promedio_semana, width=0.5)

    for r in rects:
        height = r.get_height() 
        plt.text(r.get_x() + r.get_width()/2.0, height, '%d' % int(height), ha='center', va='bottom')

    plt.show()

    #Dia 1 llamada voicemail
    voicemail_dia1_7am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("07:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia1_8am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("08:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia1_9am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("09:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia1_10am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("10:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia1_11am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("11:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia1_12pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("12:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia1_1pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("01:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia1_2pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("02:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]           
    voicemail_dia1_3pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("03:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia1_4pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("04:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia1_5pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("05:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia1_6pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("06:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]

 #Dia 2 llamada voicemail
    voicemail_dia2_7am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("07:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia2_8am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("08:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia2_9am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("09:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia2_10am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("10:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia2_11am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("11:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia2_12pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("12:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia2_1pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("01:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia2_2pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("02:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]           
    voicemail_dia2_3pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("03:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia2_4pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("04:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia2_5pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("05:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia2_6pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("06:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]

 #Dia 3 llamada voicemail
    voicemail_dia3_7am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("07:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia3_8am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("08:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia3_9am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("09:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia3_10am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("10:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia3_11am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("11:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia3_12pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("12:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia3_1pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("01:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia3_2pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("02:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]           
    voicemail_dia3_3pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("03:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia3_4pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("04:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia3_5pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("05:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia3_6pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("06:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]

 #Dia 4 llamada voicemail
    voicemail_dia4_7am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("07:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia4_8am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("08:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia4_9am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("09:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia4_10am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("10:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia4_11am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("11:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia4_12pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("12:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia4_1pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("01:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia4_2pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("02:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]           
    voicemail_dia4_3pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("03:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia4_4pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("04:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia4_5pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("05:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia4_6pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("06:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]

 #Dia 5 llamada voicemail
    voicemail_dia5_7am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("07:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia5_8am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("08:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia5_9am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("09:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia5_10am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("10:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia5_11am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("11:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia5_12pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("12:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia5_1pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("01:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia5_2pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("02:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]           
    voicemail_dia5_3pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("03:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia5_4pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("04:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia5_5pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("05:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia5_6pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("06:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]

 #Dia 6 llamada voicemail
    voicemail_dia6_7am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("07:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia6_8am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("08:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia6_9am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("09:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia6_10am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("10:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia6_11am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("11:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia6_12pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("12:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia6_1pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("01:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia6_2pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("02:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]           
    voicemail_dia6_3pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("03:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia6_4pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("04:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia6_5pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("05:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia6_6pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("06:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]

 #Dia 7 llamada voicemail
    voicemail_dia7_7am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("07:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia7_8am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("08:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia7_9am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("09:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia7_10am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("10:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia7_11am = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("11:")) & (df_new.Hora.str.contains("AM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia7_12pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("12:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia7_1pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("01:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia7_2pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("02:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]           
    voicemail_dia7_3pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("03:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia7_4pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("04:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia7_5pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("05:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]
    voicemail_dia7_6pm = df_new[(df_new.Origen.eq(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("06:")) & (df_new.Hora.str.contains("PM")) & (df_new.NumeroSaliente.str.contains("8000")) & (df_new.Duracion.astype(str).map(len) > 0)]


    voicemail_promedio_7am = round((len(voicemail_dia1_7am)+len(voicemail_dia2_7am)+len(voicemail_dia3_7am)+len(voicemail_dia4_7am)+len(voicemail_dia5_7am)+len(voicemail_dia6_7am)+len(voicemail_dia7_7am))/7)
    voicemail_promedio_8am = round((len(voicemail_dia1_8am)+len(voicemail_dia2_8am)+len(voicemail_dia3_8am)+len(voicemail_dia4_8am)+len(voicemail_dia5_8am)+len(voicemail_dia6_8am)+len(voicemail_dia7_8am))/7)
    voicemail_promedio_9am = round((len(voicemail_dia1_9am)+len(voicemail_dia2_9am)+len(voicemail_dia3_9am)+len(voicemail_dia4_9am)+len(voicemail_dia5_9am)+len(voicemail_dia6_9am)+len(voicemail_dia7_9am))/7)
    voicemail_promedio_10am = round((len(voicemail_dia1_10am)+len(voicemail_dia2_10am)+len(voicemail_dia3_10am)+len(voicemail_dia4_10am)+len(voicemail_dia5_10am)+len(voicemail_dia6_10am)+len(voicemail_dia7_10am))/7)
    voicemail_promedio_11am = round((len(voicemail_dia1_11am)+len(voicemail_dia2_11am)+len(voicemail_dia3_11am)+len(voicemail_dia4_11am)+len(voicemail_dia5_11am)+len(voicemail_dia6_11am)+len(voicemail_dia7_11am))/7)
    voicemail_promedio_12pm = round((len(voicemail_dia1_12pm)+len(voicemail_dia2_12pm)+len(voicemail_dia3_12pm)+len(voicemail_dia4_12pm)+len(voicemail_dia5_12pm)+len(voicemail_dia6_12pm)+len(voicemail_dia7_12pm))/7)
    voicemail_promedio_1pm = round((len(voicemail_dia1_1pm)+len(voicemail_dia2_1pm)+len(voicemail_dia3_1pm)+len(voicemail_dia4_1pm)+len(voicemail_dia5_1pm)+len(voicemail_dia6_1pm)+len(voicemail_dia7_1pm))/7)
    voicemail_promedio_2pm = round((len(voicemail_dia1_2pm)+len(voicemail_dia2_2pm)+len(voicemail_dia3_2pm)+len(voicemail_dia4_2pm)+len(voicemail_dia5_2pm)+len(voicemail_dia6_2pm)+len(voicemail_dia7_2pm))/7)
    voicemail_promedio_3pm = round((len(voicemail_dia1_3pm)+len(voicemail_dia2_3pm)+len(voicemail_dia3_3pm)+len(voicemail_dia4_3pm)+len(voicemail_dia5_3pm)+len(voicemail_dia6_3pm)+len(voicemail_dia7_3pm))/7)
    voicemail_promedio_4pm = round((len(voicemail_dia1_4pm)+len(voicemail_dia2_4pm)+len(voicemail_dia3_4pm)+len(voicemail_dia4_4pm)+len(voicemail_dia5_4pm)+len(voicemail_dia6_4pm)+len(voicemail_dia7_4pm))/7)
    voicemail_promedio_5pm = round((len(voicemail_dia1_5pm)+len(voicemail_dia2_5pm)+len(voicemail_dia3_5pm)+len(voicemail_dia4_5pm)+len(voicemail_dia5_5pm)+len(voicemail_dia6_5pm)+len(voicemail_dia7_5pm))/7)
    voicemail_promedio_6pm = round((len(voicemail_dia1_6pm)+len(voicemail_dia2_6pm)+len(voicemail_dia3_6pm)+len(voicemail_dia4_6pm)+len(voicemail_dia5_6pm)+len(voicemail_dia6_6pm)+len(voicemail_dia7_6pm))/7)

    voicemail_promedio_semana = [voicemail_promedio_7am, voicemail_promedio_8am, voicemail_promedio_9am, 
                      voicemail_promedio_10am, voicemail_promedio_11am, voicemail_promedio_12pm, voicemail_promedio_1pm, voicemail_promedio_2pm, 
                      voicemail_promedio_3pm, voicemail_promedio_4pm, voicemail_promedio_5pm, voicemail_promedio_6pm]

    plt.ylabel('Número de llamadas')
    plt.title('Promedio de llamadas salientes al voice mail por hora en ' + i + ' del ' + dia1 + ' - ' + dia7)
    rects = plt.bar(Horas,voicemail_promedio_semana, width=0.5)

    for r in rects:
        height = r.get_height() 
        plt.text(r.get_x() + r.get_width()/2.0, height, '%d' % int(height), ha='center', va='bottom')

    plt.show()

    #Dia 1 llamada interna local
    interna_local_dia1_7am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("07:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia1_8am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("08:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia1_9am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("09:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia1_10am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("10:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia1_11am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("11:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia1_12pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("12:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia1_1pm = df_new[((df_new.Origen.eq(i)) & df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("01:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia1_2pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("02:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]           
    interna_local_dia1_3pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("03:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia1_4pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("04:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia1_5pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("05:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia1_6pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("06:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]

 #Dia 2 llamada interna local
    interna_local_dia2_7am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("07:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia2_8am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("08:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia2_9am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("09:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia2_10am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("10:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia2_11am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("11:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia2_12pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("12:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia2_1pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("01:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia2_2pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("02:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]           
    interna_local_dia2_3pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("03:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia2_4pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("04:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia2_5pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("05:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia2_6pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("06:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]

 #Dia 3 llamada interna local
    interna_local_dia3_7am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("07:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia3_8am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("08:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia3_9am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("09:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia3_10am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("10:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia3_11am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("11:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia3_12pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("12:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia3_1pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("01:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia3_2pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("02:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]           
    interna_local_dia3_3pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("03:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia3_4pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("04:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia3_5pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("05:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia3_6pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("06:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]

 #Dia 4 llamada interna local
    interna_local_dia4_7am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("07:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia4_8am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("08:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia4_9am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("09:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia4_10am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("10:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia4_11am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("11:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia4_12pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("12:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia4_1pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("01:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia4_2pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("02:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]           
    interna_local_dia4_3pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("03:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia4_4pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("04:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia4_5pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("05:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia4_6pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("06:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]

 #Dia 5 llamada interna local
    interna_local_dia5_7am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("07:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia5_8am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("08:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia5_9am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("09:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia5_10am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("10:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia5_11am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("11:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia5_12pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("12:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia5_1pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("01:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia5_2pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("02:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]           
    interna_local_dia5_3pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("03:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia5_4pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("04:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia5_5pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("05:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia5_6pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("06:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]

 #Dia 6 llamada interna local
    interna_local_dia6_7am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("07:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia6_8am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("08:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia6_9am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("09:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia6_10am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("10:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia6_11am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("11:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia6_12pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("12:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia6_1pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("01:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia6_2pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("02:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]           
    interna_local_dia6_3pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("03:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia6_4pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("04:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia6_5pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("05:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia6_6pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("06:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]

 #Dia 7 llamada interna local
    interna_local_dia7_7am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("07:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia7_8am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("08:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia7_9am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("09:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia7_10am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("10:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia7_11am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("11:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia7_12pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("12:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia7_1pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("01:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia7_2pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("02:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]           
    interna_local_dia7_3pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("03:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia7_4pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("04:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia7_5pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("05:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_local_dia7_6pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.eq(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("06:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]


    interna_local_promedio_7am = round((len(interna_local_dia1_7am)+len(interna_local_dia2_7am)+len(interna_local_dia3_7am)+len(interna_local_dia4_7am)+len(interna_local_dia5_7am)+len(interna_local_dia6_7am)+len(interna_local_dia7_7am))/7)
    interna_local_promedio_8am = round((len(interna_local_dia1_8am)+len(interna_local_dia2_8am)+len(interna_local_dia3_8am)+len(interna_local_dia4_8am)+len(interna_local_dia5_8am)+len(interna_local_dia6_8am)+len(interna_local_dia7_8am))/7)
    interna_local_promedio_9am = round((len(interna_local_dia1_9am)+len(interna_local_dia2_9am)+len(interna_local_dia3_9am)+len(interna_local_dia4_9am)+len(interna_local_dia5_9am)+len(interna_local_dia6_9am)+len(interna_local_dia7_9am))/7)
    interna_local_promedio_10am = round((len(interna_local_dia1_10am)+len(interna_local_dia2_10am)+len(interna_local_dia3_10am)+len(interna_local_dia4_10am)+len(interna_local_dia5_10am)+len(interna_local_dia6_10am)+len(interna_local_dia7_10am))/7)
    interna_local_promedio_11am = round((len(interna_local_dia1_11am)+len(interna_local_dia2_11am)+len(interna_local_dia3_11am)+len(interna_local_dia4_11am)+len(interna_local_dia5_11am)+len(interna_local_dia6_11am)+len(interna_local_dia7_11am))/7)
    interna_local_promedio_12pm = round((len(interna_local_dia1_12pm)+len(interna_local_dia2_12pm)+len(interna_local_dia3_12pm)+len(interna_local_dia4_12pm)+len(interna_local_dia5_12pm)+len(interna_local_dia6_12pm)+len(interna_local_dia7_12pm))/7)
    interna_local_promedio_1pm = round((len(interna_local_dia1_1pm)+len(interna_local_dia2_1pm)+len(interna_local_dia3_1pm)+len(interna_local_dia4_1pm)+len(interna_local_dia5_1pm)+len(interna_local_dia6_1pm)+len(interna_local_dia7_1pm))/7)
    interna_local_promedio_2pm = round((len(interna_local_dia1_2pm)+len(interna_local_dia2_2pm)+len(interna_local_dia3_2pm)+len(interna_local_dia4_2pm)+len(interna_local_dia5_2pm)+len(interna_local_dia6_2pm)+len(interna_local_dia7_2pm))/7)
    interna_local_promedio_3pm = round((len(interna_local_dia1_3pm)+len(interna_local_dia2_3pm)+len(interna_local_dia3_3pm)+len(interna_local_dia4_3pm)+len(interna_local_dia5_3pm)+len(interna_local_dia6_3pm)+len(interna_local_dia7_3pm))/7)
    interna_local_promedio_4pm = round((len(interna_local_dia1_4pm)+len(interna_local_dia2_4pm)+len(interna_local_dia3_4pm)+len(interna_local_dia4_4pm)+len(interna_local_dia5_4pm)+len(interna_local_dia6_4pm)+len(interna_local_dia7_4pm))/7)
    interna_local_promedio_5pm = round((len(interna_local_dia1_5pm)+len(interna_local_dia2_5pm)+len(interna_local_dia3_5pm)+len(interna_local_dia4_5pm)+len(interna_local_dia5_5pm)+len(interna_local_dia6_5pm)+len(interna_local_dia7_5pm))/7)
    interna_local_promedio_6pm = round((len(interna_local_dia1_6pm)+len(interna_local_dia2_6pm)+len(interna_local_dia3_6pm)+len(interna_local_dia4_6pm)+len(interna_local_dia5_6pm)+len(interna_local_dia6_6pm)+len(interna_local_dia7_6pm))/7)

    interna_local_promedio_semana = [interna_local_promedio_7am, interna_local_promedio_8am, interna_local_promedio_9am, 
                      interna_local_promedio_10am, interna_local_promedio_11am, interna_local_promedio_12pm, interna_local_promedio_1pm, interna_local_promedio_2pm, 
                      interna_local_promedio_3pm, interna_local_promedio_4pm, interna_local_promedio_5pm, interna_local_promedio_6pm]

    plt.ylabel('Número de llamadas')
    plt.title('Promedio de llamadas internas locales por hora en ' + i + ' del ' + dia1 + ' - ' + dia7)
    rects = plt.bar(Horas,interna_local_promedio_semana, width=0.5)

    for r in rects:
        height = r.get_height() 
        plt.text(r.get_x() + r.get_width()/2.0, height, '%d' % int(height), ha='center', va='bottom')

    plt.show()

    #Dia 1 llamada interna otros paises
    interna_internacional_dia1_7am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("07:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia1_8am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("08:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia1_9am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("09:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia1_10am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("10:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia1_11am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("11:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia1_12pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("12:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia1_1pm = df_new[((df_new.Origen.eq(i)) & df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("01:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia1_2pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("02:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]           
    interna_internacional_dia1_3pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("03:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia1_4pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("04:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia1_5pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("05:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia1_6pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia1)) & (df_new.Hora.str.contains("06:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]

 #Dia 2 llamada interna otros paises
    interna_internacional_dia2_7am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("07:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia2_8am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("08:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia2_9am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("09:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia2_10am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("10:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia2_11am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("11:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia2_12pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("12:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia2_1pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("01:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia2_2pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("02:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]           
    interna_internacional_dia2_3pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("03:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia2_4pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("04:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia2_5pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("05:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia2_6pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia2)) & (df_new.Hora.str.contains("06:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]

 #Dia 3 llamada interna otros paises
    interna_internacional_dia3_7am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("07:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia3_8am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("08:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia3_9am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("09:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia3_10am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("10:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia3_11am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("11:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia3_12pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("12:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia3_1pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("01:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia3_2pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("02:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]           
    interna_internacional_dia3_3pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("03:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia3_4pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("04:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia3_5pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("05:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia3_6pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia3)) & (df_new.Hora.str.contains("06:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]

 #Dia 4 llamada interna otros paises
    interna_internacional_dia4_7am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("07:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia4_8am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("08:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia4_9am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("09:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia4_10am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("10:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia4_11am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("11:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia4_12pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("12:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia4_1pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("01:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia4_2pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("02:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]           
    interna_internacional_dia4_3pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("03:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia4_4pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("04:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia4_5pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("05:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia4_6pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia4)) & (df_new.Hora.str.contains("06:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]

 #Dia 5 llamada interna otros paises
    interna_internacional_dia5_7am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("07:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia5_8am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("08:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia5_9am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("09:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia5_10am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("10:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia5_11am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("11:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia5_12pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("12:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia5_1pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("01:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia5_2pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("02:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]           
    interna_internacional_dia5_3pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("03:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia5_4pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("04:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia5_5pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("05:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia5_6pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia5)) & (df_new.Hora.str.contains("06:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]

 #Dia 6 llamada interna otros paises
    interna_internacional_dia6_7am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("07:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia6_8am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("08:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia6_9am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("09:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia6_10am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("10:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia6_11am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("11:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia6_12pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("12:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia6_1pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("01:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia6_2pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("02:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]           
    interna_internacional_dia6_3pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("03:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia6_4pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("04:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia6_5pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("05:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia6_6pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia6)) & (df_new.Hora.str.contains("06:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]

 #Dia 7 llamada interna otros paises
    interna_internacional_dia7_7am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("07:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia7_8am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("08:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia7_9am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("09:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia7_10am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("10:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia7_11am = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("11:")) & (df_new.Hora.str.contains("AM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia7_12pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("12:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia7_1pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("01:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia7_2pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("02:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]           
    interna_internacional_dia7_3pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("03:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia7_4pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("04:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia7_5pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("05:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]
    interna_internacional_dia7_6pm = df_new[(df_new.Origen.eq(i)) & (df_new.Destino.ne(i)) & (df_new.Hora.str.contains(dia7)) & (df_new.Hora.str.contains("06:")) & (df_new.Hora.str.contains("PM")) & (df_new.Numero.astype(str).map(len) == 4) & (df_new.NumeroSaliente.astype(str).map(len) == 4) & (df_new.Duracion.astype(str).map(len) > 0)]


    interna_internacional_promedio_7am = round((len(interna_internacional_dia1_7am)+len(interna_internacional_dia2_7am)+len(interna_internacional_dia3_7am)+len(interna_internacional_dia4_7am)+len(interna_internacional_dia5_7am)+len(interna_internacional_dia6_7am)+len(interna_internacional_dia7_7am))/7)
    interna_internacional_promedio_8am = round((len(interna_internacional_dia1_8am)+len(interna_internacional_dia2_8am)+len(interna_internacional_dia3_8am)+len(interna_internacional_dia4_8am)+len(interna_internacional_dia5_8am)+len(interna_internacional_dia6_8am)+len(interna_internacional_dia7_8am))/7)
    interna_internacional_promedio_9am = round((len(interna_internacional_dia1_9am)+len(interna_internacional_dia2_9am)+len(interna_internacional_dia3_9am)+len(interna_internacional_dia4_9am)+len(interna_internacional_dia5_9am)+len(interna_internacional_dia6_9am)+len(interna_internacional_dia7_9am))/7)
    interna_internacional_promedio_10am = round((len(interna_internacional_dia1_10am)+len(interna_internacional_dia2_10am)+len(interna_internacional_dia3_10am)+len(interna_internacional_dia4_10am)+len(interna_internacional_dia5_10am)+len(interna_internacional_dia6_10am)+len(interna_internacional_dia7_10am))/7)
    interna_internacional_promedio_11am = round((len(interna_internacional_dia1_11am)+len(interna_internacional_dia2_11am)+len(interna_internacional_dia3_11am)+len(interna_internacional_dia4_11am)+len(interna_internacional_dia5_11am)+len(interna_internacional_dia6_11am)+len(interna_internacional_dia7_11am))/7)
    interna_internacional_promedio_12pm = round((len(interna_internacional_dia1_12pm)+len(interna_internacional_dia2_12pm)+len(interna_internacional_dia3_12pm)+len(interna_internacional_dia4_12pm)+len(interna_internacional_dia5_12pm)+len(interna_internacional_dia6_12pm)+len(interna_internacional_dia7_12pm))/7)
    interna_internacional_promedio_1pm = round((len(interna_internacional_dia1_1pm)+len(interna_internacional_dia2_1pm)+len(interna_internacional_dia3_1pm)+len(interna_internacional_dia4_1pm)+len(interna_internacional_dia5_1pm)+len(interna_internacional_dia6_1pm)+len(interna_internacional_dia7_1pm))/7)
    interna_internacional_promedio_2pm = round((len(interna_internacional_dia1_2pm)+len(interna_internacional_dia2_2pm)+len(interna_internacional_dia3_2pm)+len(interna_internacional_dia4_2pm)+len(interna_internacional_dia5_2pm)+len(interna_internacional_dia6_2pm)+len(interna_internacional_dia7_2pm))/7)
    interna_internacional_promedio_3pm = round((len(interna_internacional_dia1_3pm)+len(interna_internacional_dia2_3pm)+len(interna_internacional_dia3_3pm)+len(interna_internacional_dia4_3pm)+len(interna_internacional_dia5_3pm)+len(interna_internacional_dia6_3pm)+len(interna_internacional_dia7_3pm))/7)
    interna_internacional_promedio_4pm = round((len(interna_internacional_dia1_4pm)+len(interna_internacional_dia2_4pm)+len(interna_internacional_dia3_4pm)+len(interna_internacional_dia4_4pm)+len(interna_internacional_dia5_4pm)+len(interna_internacional_dia6_4pm)+len(interna_internacional_dia7_4pm))/7)
    interna_internacional_promedio_5pm = round((len(interna_internacional_dia1_5pm)+len(interna_internacional_dia2_5pm)+len(interna_internacional_dia3_5pm)+len(interna_internacional_dia4_5pm)+len(interna_internacional_dia5_5pm)+len(interna_internacional_dia6_5pm)+len(interna_internacional_dia7_5pm))/7)
    interna_internacional_promedio_6pm = round((len(interna_internacional_dia1_6pm)+len(interna_internacional_dia2_6pm)+len(interna_internacional_dia3_6pm)+len(interna_internacional_dia4_6pm)+len(interna_internacional_dia5_6pm)+len(interna_internacional_dia6_6pm)+len(interna_internacional_dia7_6pm))/7)

    interna_internacional_promedio_semana = [interna_internacional_promedio_7am, interna_internacional_promedio_8am, interna_internacional_promedio_9am, 
                      interna_internacional_promedio_10am, interna_internacional_promedio_11am, interna_internacional_promedio_12pm, interna_internacional_promedio_1pm, interna_internacional_promedio_2pm, 
                      interna_internacional_promedio_3pm, interna_internacional_promedio_4pm, interna_internacional_promedio_5pm, interna_internacional_promedio_6pm]

    plt.ylabel('Número de llamadas')
    plt.title('Promedio de llamadas internas internacionales por hora en ' + i + ' del ' + dia1 + ' - ' + dia7)
    rects = plt.bar(Horas,interna_internacional_promedio_semana, width=0.5)

    for r in rects:
        height = r.get_height() 
        plt.text(r.get_x() + r.get_width()/2.0, height, '%d' % int(height), ha='center', va='bottom')

    plt.show()
